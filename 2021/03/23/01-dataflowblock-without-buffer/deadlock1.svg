<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="502px" preserveAspectRatio="none" style="width:797px;height:502px;" version="1.1" viewBox="0 0 797 502" width="797px" zoomAndPan="magnify"><defs><filter height="300%" id="f1tm2kkl27qyvd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93.5" x2="93.5" y1="38.2969" y2="461.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="394" x2="394" y1="38.2969" y2="461.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="693.5" x2="693.5" y1="38.2969" y2="461.8906"/><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="60.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="67.5" y="22.9951">Source</text><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="60.5" y="460.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="67.5" y="480.8857">Source</text><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="347" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="354" y="22.9951">Propagator</text><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="347" y="460.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="354" y="480.8857">Propagator</text><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="662.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="669.5" y="22.9951">Target</text><rect fill="#FEFECE" filter="url(#f1tm2kkl27qyvd)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="662.5" y="460.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="669.5" y="480.8857">Target</text><rect fill="#EEEEEE" filter="url(#f1tm2kkl27qyvd)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="782" x="3" y="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="785" y1="68.8633" y2="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="785" y1="71.8633" y2="71.8633"/><rect fill="#EEEEEE" filter="url(#f1tm2kkl27qyvd)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="376" x="206" y="58.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="357" x="212" y="74.3638">(1) 単純な送信 + (2) Propagator の意思で再送信を試行</text><polygon fill="#A80036" points="82,108.5625,92,112.5625,82,116.5625,86,112.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="88" y1="112.5625" y2="112.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="10" y="107.4966">(1) Start</text><path d="M8,125.5625 L8,150.5625 L176,150.5625 L176,135.5625 L166,125.5625 L8,125.5625 " fill="#FBFB77" filter="url(#f1tm2kkl27qyvd)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M166,125.5625 L166,135.5625 L176,135.5625 L166,125.5625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="14" y="142.6294">(1) Enter OutgoingLock</text><polygon fill="#A80036" points="382,176.8281,392,180.8281,382,184.8281,386,180.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="388" y1="180.8281" y2="180.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="10" y="175.7622">(2) Start</text><polygon fill="#A80036" points="682,205.9609,692,209.9609,682,213.9609,686,209.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394" x2="688" y1="209.9609" y2="209.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="401" y="204.895">(2) OfferMessage(consumeToAccept: true)</text><path d="M608,222.9609 L608,247.9609 L776,247.9609 L776,232.9609 L766,222.9609 L608,222.9609 " fill="#FBFB77" filter="url(#f1tm2kkl27qyvd)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M766,222.9609 L766,232.9609 L776,232.9609 L766,222.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="614" y="240.0278">(2) Enter IncomingLock</text><polygon fill="#A80036" points="405,274.2266,395,278.2266,405,282.2266,401,278.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399" x2="693" y1="278.2266" y2="278.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="411" y="273.1606">(2) ConsumeMessage</text><polygon fill="#A80036" points="105,303.3594,95,307.3594,105,311.3594,101,307.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="99" x2="393" y1="307.3594" y2="307.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="111" y="302.2935">(2) ConsumeMessage</text><path d="M11,320.3594 L11,345.3594 L172,345.3594 L172,330.3594 L162,320.3594 L11,320.3594 " fill="#FBFB77" filter="url(#f1tm2kkl27qyvd)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M162,320.3594 L162,330.3594 L172,330.3594 L162,320.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="17" y="337.4263">(2) Wait OutgoingLock</text><polygon fill="#A80036" points="382,371.625,392,375.625,382,379.625,386,375.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="94" x2="388" y1="375.625" y2="375.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="101" y="370.5591">(1) OfferMessage(consumeToAccept: false)</text><polygon fill="#A80036" points="682,400.7578,692,404.7578,682,408.7578,686,404.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="394" x2="688" y1="404.7578" y2="404.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="401" y="399.6919">(1) OfferMessage(consumeToAccept: false)</text><path d="M611,417.7578 L611,442.7578 L772,442.7578 L772,427.7578 L762,417.7578 L611,417.7578 " fill="#FBFB77" filter="url(#f1tm2kkl27qyvd)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M762,417.7578 L762,427.7578 L772,427.7578 L762,417.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="617" y="434.8247">(1) Wait IncomingLock</text><!--
@startuml
participant Source
participant Propagator
participant Target

== (1) 単純な送信 + (2) Propagator の意思で再送信を試行 ==

[-> Source : (1) Start

note over Source : (1) Enter OutgoingLock

[-> Propagator : (2) Start

Propagator -> Target : (2) OfferMessage(consumeToAccept: true)

note over Target : (2) Enter IncomingLock

Target -> Propagator : (2) ConsumeMessage
Propagator -> Source : (2) ConsumeMessage

note over Source : (2) Wait OutgoingLock

Source -> Propagator : (1) OfferMessage(consumeToAccept: false)
Propagator -> Target : (1) OfferMessage(consumeToAccept: false)

note over Target : (1) Wait IncomingLock

@enduml

PlantUML version 1.2018.13(Tue Nov 27 02:11:51 JST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.10+9-Ubuntu-0ubuntu1.20.04
Operating System: Linux
OS Version: 5.4.72-microsoft-standard-WSL2
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>